syntax = "proto3";

package infraboard.mpaas.job;
option go_package = "github.com/infraboard/mpaas/apps/job";

import "github.com/infraboard/mcube/pb/resource/base.proto";

// 执行方式
enum RUNNER_TYPE {
	// 基于K8s Job执行
	K8S_JOB = 0;
}

message Job {
    // job创建信息
	// @gotags: bson:"spec" json:"spec"
    CreateJobRequest spec = 2; 
}

message CreateJobRequest {
	// 执行器类型, 默认采用k8s job执行
	// @gotags: json:"runner_type"
	RUNNER_TYPE runner_type = 1;
	// 所属域
	// @gotags: json:"domain" validate:"required"
	string domain = 2;
	// 所属空间
	// @gotags: json:"namespace" validate:"required"
	string namespace = 3;
	// 创建人
	// @gotags: json:"create_by" validate:"required"
	string create_by = 4;
	// 图片
	// @gotags: json:"logo"
	string logo = 5;
	// 名称
	// @gotags: json:"name" validate:"required"
	string name = 6;
	// Action对应的版本, 推荐默认v1
	// @gotags: json:"version" validate:"required"
	string version = 7;
	// 展示名称
	// @gotags: json:"display_name"
	string display_name = 8;
	// 是否是公开Job, 默认只能本空间内访问
	// @gotags: json:"is_public"
	mcube.resource.VISIABLE_MODE visiable_mode = 15;
	// 运行时 Runner传人参数, 创建完成后不能修改, 要修改请新建版本
	// @gotags: bson:"runner_params" json:"runner_params"
	map<string, string> runner_params = 10;
	// 运行时 用户传人的参数说明
	// @gotags: bson:"run_params" json:"run_params"
	repeated RunParamDesc run_params = 11;
	// 标签
	// @gotags: json:"labels"
	map<string, string> labels = 12;
	// 描述
	// @gotags: json:"description"
	string description = 13;
}

message RunParamDesc {
	// 可选/必传
	// @gotags: bson:"required" json:"required"
	bool required = 1;
	// 建的名称
	// @gotags: bson:"key_name" json:"key_name" validate:"required"
	string key_name = 4;
	// 建的描述
	// @gotags: bson:"key_desc" json:"key_desc"
	string key_desc = 5;
	// 默认值, action运行时如果未传人，会填充默认值
	// @gotags: bson:"default_value" json:"default_value"
	string default_value = 2;
	// 值描述
	// @gotags: bson:"value_desc" json:"value_desc"
	string value_desc = 3;
}